\documentclass[notes.tex]{subfiles}

\begin{document}

\chapter{Kan extensions}
\label{sec:kan_extensions}

\section{Motivation}
\label{sec:kan_extensions_motivation}

Let $\mathsf{C}$ be a category, and $\mathcal{I}\colon \mathsf{S} \to \mathsf{C}$ a subcategory inclusion. Given a functor $\mathcal{F}$ from $\mathsf{C}$ to any category $\mathsf{D}$, we can restrict $\mathcal{F}$ to $\mathsf{S}$ by pulling it back with $\mathcal{I}$. We denote this restriction by
\begin{equation*}
  \mathcal{I}^{*}(\mathcal{F}) = \mathcal{F} \circ \mathcal{I}.
\end{equation*}

In fact, $\mathcal{I}$ induces a functor from the category of functors $\mathsf{C} \to \mathsf{D}$ (\hyperref[def:functorcategory]{Definition~\ref*{def:functorcategory}}) to the category of functors $\mathsf{S} \to \mathsf{D}$. Recall that we denoted these categories by $[\mathsf{C}, \mathsf{D}]$ and $[\mathsf{S}, \mathsf{D}]$ respectively. What we have created is a functor
\begin{equation*}
  \mathcal{I}^{*}\colon [\mathsf{C}, \mathsf{D}] \to [\mathsf{S}, \mathsf{D}]
\end{equation*}
which acts on functors $\mathsf{C} \to \mathsf{D}$ by restricting their domain to the subcategory $\mathsf{S}$.

Admittedly, restricting the domain of a functor is not a very good party trick, even if done in a functorial way. The more impressive thing would be to \emph{extend} the domain of a functor along some inclusion. The problem of extending the domain of a functor is one example of the sort of problem that Kan extensions are designed to do.

We have come up against the problem of finding a weak inverse to a lossy process before. For example, it is easy to turn a group into a set via the lossy process of forgetting the group structure; this is done by a functor $\mathcal{U}\colon \mathsf{Grp} \to \mathsf{Set}$. The inverse problem, i.e. turning a set into a group, is solved (to the extent possible) by taking a left adjoint to the forgetful functor. Together, these two functors form an adjunction, an example of a more general phenomenon known as \emph{free-forgetful adjunction} (\hyperref[eg:freeforgetfuladjunctions]{Note~\ref*{eg:freeforgetfuladjunctions}}). If we believe the mantra that adjunctions are weak inverses, we should try to solve the problem of extending the domain of a functor by searching for a functor which is adjoint to the restriction functor $\mathcal{I}^{*}$.

Of course, it is also interesting to consider the case where $\mathcal{I}$ is not an inclusion. In fact, we will see that by choosing $\mathcal{I}$ in different ways leads to a generalization of many different categorical concepts, such as limits.

\section{Global Kan extensions}
\label{sec:global_kan_extensions}

The most high-level notion (although, as we will see, not the most useful) of a Kan extension is called a \emph{global Kan extension.} This is the concept discussed in \hyperref[sec:kan_extensions_motivation]{Section~\ref*{sec:kan_extensions_motivation}}.

\begin{definition}[pullback]
  \label{def:pullback}
  Let $\mathcal{F}\colon \mathsf{C} \to \mathsf{C}'$ be a functor. For any other category $\mathsf{D}$, $\mathcal{F}$ induces a functor, called the \defn{pullback by $\mathcal{F}$},
  \begin{equation*}
    \mathcal{F}^{*}\colon [\mathsf{C}', \mathsf{D}] \to [\mathsf{C}, \mathsf{D}]
  \end{equation*}
  which sends a functor $\mathcal{G}\colon \mathsf{C}' \to \mathsf{D}$ to its precomposition $\mathcal{G} \circ \mathcal{F}$
  \begin{equation*}
    \begin{tikzcd}
      \mathsf{C}'
      \arrow[r, "\mathcal{G}"]
      & \mathsf{D}
    \end{tikzcd}
    \qquad
    \mapsto
    \qquad
    \begin{tikzcd}
      \mathsf{C}
      \arrow[dr, swap, "\mathcal{F}"]
      \arrow[rr, "\mathcal{F}^{*}\mathcal{G}"]
      && \mathsf{D}
      \\
      & \mathsf{C'}
      \arrow[ur, swap, "\mathcal{G}"]
    \end{tikzcd}
  \end{equation*}
  and a natural transformation $\eta\colon \mathcal{G} \to \mathcal{G}'$ to its left whiskering (\hyperref[eg:whiskering]{Example~\ref*{eg:whiskering}}) $\eta\mathcal{F}$.
  \begin{equation*}
    \begin{tikzcd}[column sep=huge]
      \mathsf{C}
      \arrow[r, "\mathcal{F}"]
      &\mathsf{C}'
      \arrow[r, bend left, "\mathcal{G}"{name=U}]
      \arrow[r, bend right, swap, "\mathcal{G}'"{name=D}]
      & \mathsf{D}
      \arrow[from=U, to=D, Rightarrow, "\eta"]
    \end{tikzcd}
    \qquad
    \mapsto
    \qquad
    \begin{tikzcd}[column sep=huge]
      \mathsf{C}
      \arrow[r, bend left, "\mathcal{G} \circ \mathcal{F}"{name=U}]
      \arrow[r, bend right, swap, "\mathcal{G} \circ \mathcal{F}'"{name=D}]
      & \mathsf{D}
      \arrow[from=U, to=D, Rightarrow, "\mathcal{F}^{*}(\eta)"]
    \end{tikzcd}
  \end{equation*}
\end{definition}

\begin{definition}[Kan extension functor]
  \label{def:kan_extension}
  Consider the pullback functor $\mathcal{F}^{*}$.
  
  \begin{itemize}
    \item If $\mathcal{F}^{*}$ has right adjoint
      \begin{equation*}
        \mathcal{F}_{*}\colon [\mathsf{C}, \mathsf{D}] \to [\mathsf{C}', \mathsf{D}].
      \end{equation*}
      We call $\mathcal{F}_{*}$ the \defn{right Kan extension functor} along $\mathcal{F}$.
      %, and for any $\mathcal{G} \in [\mathsf{C}, \mathsf{D}]$, we call $\mathcal{F}_{*}(\mathcal{G})$ the \defn{right Kan extension of $\mathcal{G}$ along $\mathcal{F}$}.

    \item If $\mathcal{F}^{*}$ has left adjoint
      \begin{equation*}
        \mathcal{F}_{!}\colon [\mathsf{C}, \mathsf{D}] \to [\mathsf{C}', \mathsf{D}].
      \end{equation*}
      We call $\mathcal{F}_{!}$ the \defn{left Kan extension functor} along $\mathcal{F}$. 
      %For $\mathcal{\mathcal{G}} \in [\mathsf{C}, \mathsf{D}]$, we call $\mathcal{F}_{!}(\mathcal{G})$ the \defn{left Kan extension of $\mathcal{G}$ along $\mathcal{F}$}.
  \end{itemize}
\end{definition}

\begin{example}[Kan extensions capture limits and colimits]
  \label{eg:kan_extensions_capture_limits_and_colimits}
  Consider the case in which $\mathsf{C}'$ is the terminal category $\mathsf{1}$ (\hyperref[eg:categorywithoneobject]{Example~\ref*{eg:categorywithoneobject}}). There is a unique functor from any category $\mathsf{C} \to \mathsf{1}$, which sends every object to the unique object $* \in \Obj(\mathsf{1})$ and every morphism to the identity morphism. Furthermore, any functor $\mathcal{F}\colon 1 \to \mathsf{D}$ is completely determined by where it sends the unique object $*$.

  Now fix categories $\mathsf{C}$ and $\mathsf{D}$, and consider the unique functor $\mathcal{C}\colon \mathsf{C} \to \mathsf{1}$.

  The restriction of any $\mathcal{F}\colon \mathsf{1} \to \mathsf{C}$ along $\mathcal{C}$ is simply the constant functor $\Delta_{\mathcal{F}(*)}$. Therefore, the functor $\mathcal{C}^{*}\colon [\mathsf{1},\mathsf{D}] \to [\mathsf{C}, \mathsf{D}]$ carries exactly the same data as the diagonal functor $\Delta\colon \mathsf{D} \to [\mathsf{C},\mathsf{D}]$. Thus, $\mathcal{C}_{!}$ fits into the following adjunction.
  \begin{equation*}
    \mathcal{C}_{!} : [\mathsf{C}, \mathsf{D}] \leftrightarrow \mathsf{D} : \Delta
  \end{equation*}

  But we have seen that the colimit functor is right adjoint to the diagonal functor, so we have a natural isomorphism
  \begin{equation*}
    \mathcal{C}_{!} \simeq \lim_{\rightarrow}.
  \end{equation*}
  That is, the left Kan extension of any functor $\mathcal{D}$ along the terminal functor $\mathcal{C}$ is\footnote{Strictly speaking, we should write ``uniquely isomorphic to,'' but we don't because limits are only defined up to unique isomorphism anyway.} the colimit of $\mathcal{D}$:
  \begin{equation*}
    \mathcal{C}_{!}\mathcal{D} = \lim_{\rightarrow} \mathcal{D}.
  \end{equation*}

  Exactly analogous reasoning tells us that the right Kan extension of any functor $\mathcal{D}$ along the terminal functor $\mathcal{C}$ is the limit of $\mathcal{D}$:
  \begin{equation*}
    \mathcal{C}_{*}\mathcal{D} = \lim_{\leftarrow} \mathcal{D}.
  \end{equation*}
\end{example}


\section{Local Kan extensions}
\label{sec:local_kan_extensions}

By \hyperref[sec:unit_counit_adjunctions_are_hom_set_adjunctions]{Section~\ref*{sec:unit_counit_adjunctions_are_hom_set_adjunctions}}, we can also look at the right-adjointness of the pullback functor $\mathcal{F}^{*}$'s as guaranteeing that for every $\mathcal{D} \in \Obj([\mathsf{C}', \mathsf{D}])$, the category $(\mathcal{F}^{*} \downarrow \mathcal{D})$ has a terminal object. Similarly, we can look at $\mathcal{F}_{!}$'s left-adjointness as demonstrating that any category $(\mathcal{D} \downarrow \mathcal{F}^{*})$ has an initial object. This mirrors the definition of limits and colimits as being terminal (resp. initial) objects in the category $(\Delta \downarrow \mathcal{D})$ (resp. $(\mathcal{D} \downarrow \Delta)$). As we saw in \hyperref[eg:kan_extensions_capture_limits_and_colimits]{Example~\ref*{eg:kan_extensions_capture_limits_and_colimits}}, this is no accident; Kan extensions form a vast generalization of limits and colimits.

For now, we will specialize our discussion to the case of right Kan extensions and limits, so as not to have to keep writing down 'resp.'

Recall that we defined limits as universal cones. We have seen that there is a functor which assigns limits, and that this is the right adjoint to the diagonal functor. This gives us another way to define limits: we could first have defined the limit functor as right adjoint to the diagonal functor, and then defined limits as being the images of the limit functor. However, this would have been an unnecessarily restrictive definition, since in general some, but not all, limits exist; if we had chosen to define limits in this functorial way, in order to define limits for any diagram $\mathcal{D}\colon \mathsf{J} \to \mathsf{C}$ we would have had to demand that limits exist for \emph{every} diagram in $\mathsf{D}$. Clearly this is not what we want; for example, we want to be able to take products of two objects in a category without worrying about whether all limits exist in that category.

Fortunately, this is not what we did: we first defined the categories $(\Delta \downarrow \mathcal{D})$, then defined limits as their terminal objects. Only much later did we show that under certain conditions, limits organized themselves into a functor whose left adjoint was the diagonal functor.

By comparison, we first defined right Kan extensions as right adjoints to a restriction functor, then showed that their existence was equivalent to the existence of terminal morphisms in appropriate comma categories. The analogy with limits suggests that we can define Kan extension of one functor along another even when not all extensions exist.

\begin{definition}[local Kan extension]
  \label{def:local_kan_extension}
  Consider categories and functors as below.
  \begin{equation*}
    \begin{tikzcd}
      \mathsf{C}
      \arrow[dr, swap, "\mathcal{F}"]
      \arrow[rr, "\mathcal{D}"]
      && \mathsf{D}
      \\
      & \mathsf{C'}
    \end{tikzcd}
  \end{equation*}
  \begin{itemize}
    \item A \defn{right Kan extension of $\mathcal{D}$ along $\mathcal{F}$} is a terminal morphism in the category $(\mathcal{F}^{*} \downarrow \mathcal{D})$.

    \item A \defn{left Kan extension of $\mathcal{D}$ along $\mathcal{F}$} is a terminal morphism in the category $(\mathcal{D}\downarrow \mathcal{F}^{*})$.
  \end{itemize}
\end{definition}

This local definition will turn out to be much more useful than \hyperref[def:kan_extension]{Definition~\ref*{def:kan_extension}}. It will even to allow us to compute Kan extensions via an explicit formula in certain situations.

\subsection{Extensions}
\label{ssc:extensions}

An extension is an approximate solution to the problem that the Kan extension solves.

\begin{definition}[extension]
  \label{def:extension}
  Consider categories and functors as below.
  \begin{equation*}
    \begin{tikzcd}
      \mathsf{C}
      \arrow[dr, swap, "\mathcal{F}"]
      \arrow[rr, "\mathcal{D}"]
      && \mathsf{D}
      \\
      & \mathsf{C'}
    \end{tikzcd}
  \end{equation*}
  \begin{itemize}
    \item A \defn{right extension of $\mathcal{G}$ along $\mathcal{F}$} is an object in the comma category $(\mathcal{F}^{*} \downarrow \mathcal{D})$. That is, it is a pair $(\mathcal{G}, \eta)$, where $\mathcal{G}\colon \mathsf{C}' \to \mathsf{D}$ and
      \begin{equation*}
        \eta\colon \mathcal{D} \Rightarrow \mathcal{F}^{*}\mathcal{G}
      \end{equation*}

    \item A \defn{left extension of $\mathcal{G}$ along $\mathcal{F}$} is an object in the comma category $(\mathcal{D} \downarrow \mathcal{F}^{*})$.
  \end{itemize}
\end{definition}

\subsection{Right extensions induce cones}
\label{ssc:right_extensions_induce_cones}

Let $\mathcal{D}\colon \mathsf{C} \to \mathsf{D}$ and $\mathcal{F}\colon \mathsf{C} \to \mathsf{C'}$ be functors. Let $(G, \eta)$ be a right extension of $\mathcal{D}$ along $\mathcal{F}$.
\begin{equation*}
  \begin{tikzcd}
    \mathsf{C}
    \arrow[dr, swap, "\mathcal{F}"]
    \arrow[rr, "\mathcal{D}", ""'{name=U}]
    && \mathsf{D}
    \\
    & \mathsf{C'}
    \arrow[ur, swap, "\mathcal{G}"]
    \arrow[d, to=U, Rightarrow, swap, "\eta"] 
  \end{tikzcd}
\end{equation*}
For any $c \in \Obj(\mathsf{C}')$, denote by $(c \downarrow \mathcal{F})$ the category of morphisms from $c$ down to $\mathcal{F}$ (see \hyperref[def:categoryofmorphismsfromanobjecttoafunctor]{Definition~\ref*{def:categoryofmorphismsfromanobjecttoafunctor}}), and denote by $\mathcal{U}$ the forgetful functor $(c \downarrow \mathcal{F}) \to \mathsf{C}$. We can define a functor $\evl{\mathcal{D}}_{(c \downarrow \mathcal{F})}\colon (c \downarrow \mathcal{F}) \to \mathsf{D}$ as the following composition.
\begin{equation*}
  \begin{tikzcd}
    (c \downarrow \mathcal{F})
    \arrow[r, "\mathcal{U}"]
    & \mathsf{C}
    \arrow[r, "\mathcal{D}"]
    & \mathsf{D}
  \end{tikzcd}
\end{equation*}

To each such $c \in \Obj(\mathsf{C}')$, there is an associated cone $\xi$ over $\evl{\mathcal{D}}_{(c \downarrow \mathcal{F})}$, constructed as follows.

\begin{itemize}
  \item The tip of the cone is $\mathcal{D}(c)$.

  \item For each $(e, f) \in \Obj(c \downarrow \mathcal{F})$, the morphism $\xi_{(e, f)}\colon\mathcal{D}(c) \to \evl{\mathcal{D}}_{(c \downarrow \mathcal{F})}(e, f) = \mathcal{D}(e)$ is given by the composition
    \begin{equation*}
      \begin{tikzcd}
        \mathcal{G}(c)
        \arrow[r, "\mathcal{G}(f)"]
        & \mathcal{G}(\mathcal{F}(e))
        \arrow[r, "\eta_{e}"]
        & \mathcal{D}(e)
      \end{tikzcd}.
    \end{equation*}
\end{itemize}

\begin{lemma}
  \label{lemma:right_extension_induces_cone}
  The cone described above really is a cone. That is, for each morphism $g\colon (e, f) \to (e', f')$,
  \begin{equation*}
    \begin{tikzcd}[column sep=tiny]
      & c
      \arrow[ld, swap, "f"]
      \arrow[rd, "f'"]
      \\
      \mathcal{F}(e)
      \arrow[rr, swap, "\mathcal{F}(g)"]
      && \mathcal{F}(e')
    \end{tikzcd}
  \end{equation*}
  the diagram
  \begin{equation*}
    \begin{tikzcd}[column sep=tiny]
      & \mathcal{D}(c)
      \arrow[dl, swap, "\xi_{(e, f)}"]
      \arrow[dr, "\xi_{(e', f')}"]
      \\
      \mathcal{D}(e)
      \arrow[rr, swap, "\mathcal{D}(g)"]
      && \mathcal{D}(e')
    \end{tikzcd}
  \end{equation*}
  commutes.
\end{lemma}
\begin{proof}
  Consider the following diagram.
  \begin{equation*}
    \begin{tikzcd}[column sep=tiny]
      & \mathcal{D}(c)
      \arrow[ld, swap, "\mathcal{G}(f)"]
      \arrow[rd, "\mathcal{G}(f')"]
      \\
      (\mathcal{G} \circ \mathcal{F})(e)
      \arrow[rr, swap, "\mathcal{G} \circ \mathcal{F}(e)"]
      \arrow[d, swap, "\eta_{e}"]
      && \mathcal{G} \circ \mathcal{F}(e')
      \arrow[d, "\eta_{e'}"]
      \\
      \mathcal{D}(e)
      \arrow[rr, swap, "\mathcal{D}(f)"]
      &&\mathcal{D}(e')
    \end{tikzcd}
  \end{equation*}
  The upper triangle is the functor $\mathcal{D}$ applied to the definition of commutativity in a category of morphisms, and the lower square is the naturality square for $\eta$.
\end{proof}

\begin{lemma}
  \label{lemma:morphism_induces_functor_between_comma_categories}
  Let $\mathcal{F}\colon \mathsf{I} \to \mathsf{J}$ be a functor. Let $f\colon j \to j'$ be a morphism in $\mathsf{J}$. Then $\mathcal{F}$ induces the following functors.
  \begin{itemize}
    \item $(\mathcal{F} \downarrow j) \to (\mathcal{F} \downarrow j')$.

    \item $(j' \downarrow \mathcal{F}) \to (j \downarrow \mathcal{F})$.
  \end{itemize}
\end{lemma}
\begin{proof}
  \begin{equation*}
    \begin{tikzcd}
      \mathcal{F}
    \end{tikzcd}
  \end{equation*}
\end{proof}

We saw above that given any extension $(\mathcal{G}, \eta)$ and any object $c \in \Obj(\mathsf{C}')$, we could construct a cone. This cone turns out to encode a lot of interesting properties about the extension $(\mathcal{G}, \eta)$. In fact, we have the following rather astonishing result.

\begin{theorem}
  Let $(\mathcal{G}, \eta)$ be a right extension as below.
  \begin{equation*}
    \begin{tikzcd}
      \mathsf{C}
      \arrow[dr, swap, "\mathcal{F}"]
      \arrow[rr, "\mathcal{D}", ""'{name=U}]
      && \mathsf{D}
      \\
      & \mathsf{C'}
      \arrow[ur, swap, "\mathcal{G}"]
      \arrow[d, to=U, Rightarrow, swap, "\eta"] 
    \end{tikzcd}
  \end{equation*}
  If for every $c \in \Obj(\mathsf{C'})$ the cone 

  is a limit cone, then $(\mathcal{G}, \eta)$ is a right Kan extension.
\end{theorem}
\begin{proof}

\end{proof}

\section{A pointwise formula for Kan extensions}
\label{sec:a_pointwise_formula_for_kan_extensions}

This is a 


\end{document}
